<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8">
  <title>HUDBA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="data:image/svg+xml,
    <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'>
      <rect width='100' height='100' fill='black'/>
      <text x='50%' y='55%' font-size='60' text-anchor='middle' fill='cyan'>üéµ</text>
    </svg>">
  <style>
    body { margin:0; font-family:'Segoe UI',sans-serif; background:#111; color:#fff; }
    header { background:#222; padding:2em; text-align:center; }
    .upload-btn { background:linear-gradient(90deg,#00ffff,#00aaff); color:#000; padding:0.6em 1.2em; border:none; border-radius:12px; font-weight:bold; cursor:pointer; }
    main { padding:2em; display:flex; flex-direction:column; align-items:center; gap:2em; }
    .card, .player-card { background:#1f1f1f; padding:2em; border-radius:20px; max-width:600px; width:100%; text-align:center; }
    input, textarea, button { width:100%; margin:0.5em 0; padding:0.8em; border:none; border-radius:12px; font-size:1em; background:#2a2a2a; color:#fff; }
    button { background:linear-gradient(90deg,#00ffff,#00aaff); color:#000; font-weight:bold; cursor:pointer; }
    .delete-btn { background:linear-gradient(90deg,#ff4d4d,#ff1a1a); color:#fff; margin-top:1em; }
    audio { width:100%; margin-top:1em; }
  </style>
</head>
<body>
  <header>
    <h1>HUDBA</h1>
    <p>Vytvor si vlastn√Ω hudobn√Ω svet. Nahraj, poƒç√∫vaj, ulo≈æ.</p>
    <label class="upload-btn" for="fileInput">üéµ Nahra≈• audio</label>
  </header>

  <main>
    <input type="file" accept="audio/*" id="fileInput" class="hidden-upload">

    <section class="card">
      <h2>Prida≈• skladbu</h2>
      <input type="text" id="title" placeholder="N√°zov skladby">
      <input type="text" id="artist" placeholder="Interpret">
      <input type="text" id="album" placeholder="Album">
      <input type="file" accept="image/*" id="coverInput">
      <textarea id="copyright"
        placeholder="Copyright pozn√°mka"></textarea>
      <button onclick="saveTrack()">üíæ Ulo≈æi≈• skladbu</button>
    </section>

    <section class="player-card" id="playerArea">
      ≈Ωiadna skladba nie je ulo≈æen√°.
    </section>
  </main>

  <footer style="text-align:center;padding:1em;background:#000;color:#666;">
    &copy; 2025 HUDBA by KRAL
  </footer>

  <script>
    let db;
    const request = indexedDB.open("HudbaDB", 1);

    request.onupgradeneeded = function(e) {
      db = e.target.result;
      if (!db.objectStoreNames.contains("tracks")) {
        db.createObjectStore("tracks", { keyPath: "id" });
      }
    };

    request.onsuccess = function(e) {
      db = e.target.result;
      loadTrack();
    };

    function saveTrack() {
      const file = document.getElementById('fileInput').files[0];
      if (!file) return alert("Nahraj MP3 s√∫bor!");
      const reader = new FileReader();
      reader.onload = function(e) {
        const track = {
          id: "myTrack",
          title: document.getElementById('title').value || "Nezn√°my n√°zov",
          artist: document.getElementById('artist').value || "Nezn√°my interpret",
          album: document.getElementById('album').value || "Nezn√°my album",
          copyright: document.getElementById('copyright').value || "",
          audio: e.target.result
        };
        const coverFile = document.getElementById('coverInput').files[0];
        if (coverFile) {
          const coverReader = new FileReader();
          coverReader.onload = function(ev) {
            track.cover = ev.target.result;
            storeTrack(track);
          };
          coverReader.readAsDataURL(coverFile);
        } else {
          track.cover = "";
          storeTrack(track);
        }
      };
      reader.readAsDataURL(file);
    }

    function storeTrack(track) {
      const tx = db.transaction("tracks", "readwrite");
      tx.objectStore("tracks").put(track);
      tx.oncomplete = () => showPlayer(track);
    }

    function loadTrack() {
      const tx = db.transaction("tracks", "readonly");
      const req = tx.objectStore("tracks").get("myTrack");
      req.onsuccess = () => { if (req.result) showPlayer(req.result); };
    }

    function showPlayer(track) {
      const area = document.getElementById('playerArea');
      area.innerHTML = `
        ${track.cover ? `<img src="${track.cover}" alt="Obal albumu" style="max-width:100%;border-radius:12px;margin-bottom:1em;">` : ""}
        <h2>${track.title}</h2>
        <p>${track.artist} ‚Äì ${track.album}</p>
        <audio controls src="${track.audio}"></audio>
        <p><em>${track.copyright}</em></p>
        <button class="delete-btn" onclick="deleteTrack()">üóëÔ∏è Vymaza≈• hudbu</button>
      `;
    }

    function deleteTrack() {
      const tx = db.transaction("tracks", "readwrite");
      tx.objectStore("tracks").delete("myTrack");
      tx.oncomplete = () => {
        document.getElementById('playerArea').innerHTML = "≈Ωiadna skladba nie je ulo≈æen√°.";
      };
    }
  </script>
</body>
</html>



